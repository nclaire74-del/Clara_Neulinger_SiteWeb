<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔧 Diagnostic Circus 3D - Clara Neulinger</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: white;
            padding: 20px;
            line-height: 1.6;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 8px;
            background: #222;
        }
        .success { border-color: #4CAF50; background: rgba(76, 175, 80, 0.1); }
        .error { border-color: #f44336; background: rgba(244, 67, 54, 0.1); }
        .warning { border-color: #ff9800; background: rgba(255, 152, 0, 0.1); }
        .test-btn {
            background: #333;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .test-btn:hover { background: #555; }
        .path { color: #4CAF50; font-family: monospace; }
        .expected { color: #2196F3; }
        .current { color: #ff9800; }
        pre { background: #000; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>🔧 Diagnostic Complet - Circus 3D</h1>
    
    <div class="section">
        <h2>📋 Problèmes Identifiés</h2>
        <ul>
            <li><strong>Images :</strong> Chemin incorrect <span class="current">../assets/</span> → doit être <span class="expected">../../assets/</span></li>
            <li><strong>Marmoset :</strong> Injection HTML statique au lieu d'API dynamique</li>
            <li><strong>Structure :</strong> Chemins relatifs depuis circus-3d/</li>
        </ul>
    </div>

    <div class="section">
        <h2>🎯 Tests des Chemins</h2>
        <p><strong>Depuis :</strong> <span class="path">00_SITE_ACTIF/projets/circus-3d/</span></p>
        
        <div style="margin: 10px 0;">
            <strong>❌ Ancien (incorrect) :</strong><br>
            <code class="error">../assets/images/Cirucs/image.jpg</code><br>
            <small>→ Cherche dans : <span class="current">00_SITE_ACTIF/projets/assets/images/</span> (n'existe pas)</small>
        </div>
        
        <div style="margin: 10px 0;">
            <strong>✅ Nouveau (correct) :</strong><br>
            <code class="success">../../assets/images/Cirucs/image.jpg</code><br>
            <small>→ Cherche dans : <span class="expected">00_SITE_ACTIF/assets/images/</span> (existe)</small>
        </div>
        
        <button class="test-btn" onclick="testImage()">Tester Image</button>
        <button class="test-btn" onclick="testMview()">Tester .mview</button>
        <button class="test-btn" onclick="testMarmoset()">Tester Script Marmoset</button>
    </div>

    <div class="section">
        <h2>🔍 Tests en Direct</h2>
        <div id="results"></div>
    </div>

    <div class="section">
        <h2>📝 URLs de Test</h2>
        <ul>
            <li><strong>Page principale :</strong> <a href="http://localhost/Clara_Neulinger/" target="_blank">index.html</a></li>
            <li><strong>Circus 3D direct :</strong> <a href="http://localhost/Clara_Neulinger/00_SITE_ACTIF/projets/circus-3d/" target="_blank">circus-3d/index.html</a></li>
            <li><strong>Image test :</strong> <a href="http://localhost/Clara_Neulinger/00_SITE_ACTIF/assets/images/Cirucs/Neulinger_Clara_3B3D_Circus_Chara_Renders_1.jpg" target="_blank">Image Circus</a></li>
            <li><strong>Fichier .mview :</strong> <a href="http://localhost/Clara_Neulinger/00_SITE_ACTIF/assets/images/Cirucs/ok.mview" target="_blank">ok.mview</a></li>
        </ul>
    </div>

    <div class="section">
        <h2>🛠️ Corrections Effectuées</h2>
        <pre><code>✅ Chemins images corrigés : ../assets/ → ../../assets/
✅ Chemin Marmoset corrigé : ../assets/images/Cirucs/ok.mview → ../../assets/images/Cirucs/ok.mview  
✅ Code Marmoset simplifié : Suppression HTML statique, utilisation API pure
✅ Error handling amélioré : Messages de debug détaillés
</code></pre>
    </div>

    <script>
        const results = document.getElementById('results');
        
        function addResult(test, success, message) {
            const div = document.createElement('div');
            div.className = `section ${success ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${success ? '✅' : '❌'} ${test}</strong><br>${message}`;
            results.appendChild(div);
        }
        
        function testImage() {
            const imageUrl = '00_SITE_ACTIF/assets/images/Cirucs/Neulinger_Clara_3B3D_Circus_Chara_Renders_1.jpg';
            fetch(imageUrl, { method: 'HEAD' })
                .then(response => {
                    addResult('Test Image Circus', response.ok, 
                        response.ok ? 
                        `Image accessible (${response.status}) - Taille: ${response.headers.get('content-length')} bytes` : 
                        `Image inaccessible (${response.status}) - Vérifier le chemin`
                    );
                })
                .catch(error => {
                    addResult('Test Image Circus', false, `Erreur réseau: ${error.message}`);
                });
        }
        
        function testMview() {
            const mviewUrl = '00_SITE_ACTIF/assets/images/Cirucs/ok.mview';
            fetch(mviewUrl, { method: 'HEAD' })
                .then(response => {
                    addResult('Test fichier .mview', response.ok, 
                        response.ok ? 
                        `Fichier .mview accessible (${response.status}) - Taille: ${response.headers.get('content-length')} bytes` : 
                        `Fichier .mview inaccessible (${response.status})`
                    );
                })
                .catch(error => {
                    addResult('Test fichier .mview', false, `Erreur: ${error.message}`);
                });
        }
        
        function testMarmoset() {
            const marmosetUrl = '00_SITE_ACTIF/js/marmoset.js';
            fetch(marmosetUrl)
                .then(response => response.text())
                .then(content => {
                    const hasEmbed = content.includes('embed');
                    const hasMarmoset = content.includes('marmoset');
                    addResult('Test Script Marmoset', hasEmbed && hasMarmoset, 
                        `Script chargé - Contient embed: ${hasEmbed}, Contient marmoset: ${hasMarmoset}`
                    );
                })
                .catch(error => {
                    addResult('Test Script Marmoset', false, `Erreur: ${error.message}`);
                });
        }
        
        // Tests automatiques au chargement
        setTimeout(() => {
            testImage();
            testMview();
        }, 1000);
    </script>
</body>
</html>